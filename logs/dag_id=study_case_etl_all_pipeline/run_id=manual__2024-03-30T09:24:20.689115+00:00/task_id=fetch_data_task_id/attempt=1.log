[2024-03-30T09:24:21.933+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: study_case_etl_all_pipeline.fetch_data_task_id manual__2024-03-30T09:24:20.689115+00:00 [queued]>
[2024-03-30T09:24:21.939+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: study_case_etl_all_pipeline.fetch_data_task_id manual__2024-03-30T09:24:20.689115+00:00 [queued]>
[2024-03-30T09:24:21.940+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 2
[2024-03-30T09:24:21.951+0000] {taskinstance.py:2214} INFO - Executing <Task(PythonOperator): fetch_data_task_id> on 2024-03-30 09:24:20.689115+00:00
[2024-03-30T09:24:21.955+0000] {standard_task_runner.py:60} INFO - Started process 706 to run task
[2024-03-30T09:24:21.958+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'study_case_etl_all_pipeline', 'fetch_data_task_id', 'manual__2024-03-30T09:24:20.689115+00:00', '--job-id', '23', '--raw', '--subdir', 'DAGS_FOLDER/running_dbt_core/study_case_etl_all_pipeline.py', '--cfg-path', '/tmp/tmptgheno8c']
[2024-03-30T09:24:21.960+0000] {standard_task_runner.py:88} INFO - Job 23: Subtask fetch_data_task_id
[2024-03-30T09:24:21.995+0000] {task_command.py:423} INFO - Running <TaskInstance: study_case_etl_all_pipeline.fetch_data_task_id manual__2024-03-30T09:24:20.689115+00:00 [running]> on host 8e1e687a7cdb
[2024-03-30T09:24:22.053+0000] {taskinstance.py:2510} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Agus mahari' AIRFLOW_CTX_DAG_ID='study_case_etl_all_pipeline' AIRFLOW_CTX_TASK_ID='fetch_data_task_id' AIRFLOW_CTX_EXECUTION_DATE='2024-03-30T09:24:20.689115+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-03-30T09:24:20.689115+00:00'
[2024-03-30T09:24:25.388+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:24:25,388 INFO sqlalchemy.engine.Engine SELECT DATABASE()
[2024-03-30T09:24:25.388+0000] {base.py:1863} INFO - SELECT DATABASE()
[2024-03-30T09:24:25.398+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:24:25,397 INFO sqlalchemy.engine.Engine [raw sql] {}
[2024-03-30T09:24:25.397+0000] {base.py:1868} INFO - [raw sql] {}
[2024-03-30T09:24:26.375+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:24:26,375 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
[2024-03-30T09:24:26.375+0000] {base.py:1863} INFO - SELECT @@sql_mode
[2024-03-30T09:24:26.376+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:24:26,376 INFO sqlalchemy.engine.Engine [raw sql] {}
[2024-03-30T09:24:26.376+0000] {base.py:1868} INFO - [raw sql] {}
[2024-03-30T09:24:26.861+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:24:26,861 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
[2024-03-30T09:24:26.861+0000] {base.py:1863} INFO - SELECT @@lower_case_table_names
[2024-03-30T09:24:26.862+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:24:26,862 INFO sqlalchemy.engine.Engine [raw sql] {}
[2024-03-30T09:24:26.862+0000] {base.py:1868} INFO - [raw sql] {}
[2024-03-30T09:24:27.554+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:24:27,554 INFO sqlalchemy.engine.Engine 
  SELECT 
    *
FROM databasename.raw_credit_card
[2024-03-30T09:24:27.554+0000] {base.py:1863} INFO - 
  SELECT 
    *
FROM databasename.raw_credit_card
[2024-03-30T09:24:27.556+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:24:27,556 INFO sqlalchemy.engine.Engine [raw sql] {}
[2024-03-30T09:24:27.556+0000] {base.py:1868} INFO - [raw sql] {}
[2024-03-30T09:26:23.017+0000] {local_task_job_runner.py:296} WARNING - DagRun timed out after 0:02:02.164477.
[2024-03-30T09:26:28.065+0000] {local_task_job_runner.py:296} WARNING - DagRun timed out after 0:02:07.212577.
[2024-03-30T09:26:28.066+0000] {local_task_job_runner.py:302} WARNING - State of this instance has been externally set to skipped. Terminating instance.
[2024-03-30T09:26:28.069+0000] {process_utils.py:131} INFO - Sending 15 to group 706. PIDs of all processes in the group: [706]
[2024-03-30T09:26:28.069+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 706
[2024-03-30T09:26:28.081+0000] {taskinstance.py:2480} ERROR - Received SIGTERM. Terminating subprocesses.
[2024-03-30T09:26:28.082+0000] {base.py:2008} ERROR - Error closing cursor
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1910, in _execute_context
    self.dialect.do_execute(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
  File "/home/airflow/.local/lib/python3.8/site-packages/mysql/connector/cursor_cext.py", line 342, in execute
    self._handle_result(result)
  File "/home/airflow/.local/lib/python3.8/site-packages/mysql/connector/cursor_cext.py", line 230, in _handle_result
    self._handle_resultset()
  File "/home/airflow/.local/lib/python3.8/site-packages/mysql/connector/cursor_cext.py", line 788, in _handle_resultset
    self._rows = self._cnx.get_rows()[0]
  File "/home/airflow/.local/lib/python3.8/site-packages/mysql/connector/connection_cext.py", line 449, in get_rows
    row = fetch_row()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 2482, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2005, in _safe_close_cursor
    cursor.close()
  File "/home/airflow/.local/lib/python3.8/site-packages/mysql/connector/cursor_cext.py", line 495, in close
    self._cnx.handle_unread_result()
  File "/home/airflow/.local/lib/python3.8/site-packages/mysql/connector/connection_cext.py", line 955, in handle_unread_result
    raise InternalError("Unread result found")
mysql.connector.errors.InternalError: Unread result found
[2024-03-30T09:26:28.086+0000] {logging_mixin.py:188} INFO - 2024-03-30 09:26:28,086 INFO sqlalchemy.engine.Engine ROLLBACK
[2024-03-30T09:26:28.086+0000] {base.py:1060} INFO - ROLLBACK
[2024-03-30T09:26:30.164+0000] {logging_mixin.py:188} INFO - An error occurred: Task received SIGTERM signal
[2024-03-30T09:26:30.166+0000] {python.py:202} INFO - Done. Returned value was: /opt/***/data/fetch_data_task_id_2024-03-30.csv
[2024-03-30T09:26:30.194+0000] {taskinstance.py:1149} INFO - Marking task as SUCCESS. dag_id=study_case_etl_all_pipeline, task_id=fetch_data_task_id, execution_date=20240330T092420, start_date=20240330T092421, end_date=20240330T092630
[2024-03-30T09:26:30.247+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=706, status='terminated', exitcode=0, started='09:24:21') (706) terminated with exit code 0
